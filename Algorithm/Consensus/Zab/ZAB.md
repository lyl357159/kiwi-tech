# Zab
- ZAB（ZooKeeper Atomic Broadcast）协议是ZooKeeper使用的一种原子广播协议，用于实现分布式系统中数据的一致性。它与Paxos算法类似，在分布式系统中实现了状态机复制。

- ZAB协议将整个系统划分为两个阶段：Leader Election和Atomic Broadcast。

- 在Leader Election阶段，ZooKeeper集群的节点会通过选举产生一个Leader，用来负责处理客户端请求的响应。节点之间通过通信进行选举，在选举过程中，每个节点都有一个唯一标识，称为zxid，表示节点处理的最近一条事务的编号。

- 在Atomic Broadcast阶段，Leader会将客户端请求转化为一个个提议，然后将这些提议广播给其他节点进行投票。如果大多数节点都同意该提议，则Leader会将该提议写入本地日志，并将该提议的结果返回给客户端。如果某个节点落后于其他节点，则Leader会将落后节点的状态同步至最新状态。这样可以保证所有节点的数据是一致的。

 - 总的来说，ZAB协议通过Leader选举和原子广播机制，能够保证分布式系统中数据的一致性和可靠性。

## 选举策略：
  - 任何时候，集群中只有一个Leader。
  - 在一组服务器中，选择zxid值最大的那个服务器作为Leader。
  - 如果存在多个zxid值相同的服务器，则从中选择具有最大ID号的那个服务器作为Leader。
  - 新加入的机器会尝试加入集群，但是如果它加入之后不可能成为Leader，就会被拒绝。
## 选举原理：
  - 每个服务器启动时都是Follower状态。
  - Follower通过向集群中的其他节点发送请求来获取当前时刻的选票信息。
  - 每个Follower根据得到的信息，对自己的选票进行更新，并再次向集群中的其他节点发送请求。
  - 当某个Follower的选票超过半数以上的节点时，该Follower将变为Leader，并开始处理客户端的请求。
  - 如果选举没有完成或者Leader失效，那么Follower将继续进行选举过程，直到新的Leader被选出。

---
- [返回首页](../../../README.md)