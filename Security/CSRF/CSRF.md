# CSRF
  - **跨站请求伪造攻击**
  - 攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的。



## 三种常见攻击方式
  - 1.GET类型的CSRF
    > 通常请求被放置在img标签的src中，当用户访问了包含这个标签的网页时，浏览器会自动向src中的地址提交一次http请求

   - 2.自动发起POST类型请求
     > 通过构建一个隐藏的表单，表单的内容就是自动发起支付的接口请求。当用户打开该页面时，这个表单会被自动执行提交。当表单被提交之后，服务器就会执行转账操作。因此使用构建自动提交表单这种方式，就可以自动实现跨站点 POST 数据提交。

   - 3.链接类型
     > 通过夸张的广告诱导用户点击链接，跳转到危险的网站，该网站自动自动发送请求，冒充用户执行相应的操作。


## 防御办法
   CSRF有以下两个特点：一是通常发生在第三方域名，二是攻击者不能访问cookie信息，只是使用。针对这两个方面，对CSRF攻击进行相应的防护。
  - 1.确定来源域名。
   > 由于CSRF攻击大多来自第三方站点，可以在服务器端验证请求来源的站点，禁止第三方站点的请求。 可以通过HTTP请求头中的 Referer和Origin属性确定来源域名。
  - 2.设置CSRF Token
    > 在用户首次发出请求时，服务器为该用户生成一个token（一般是随机字符串和时间戳生成的随机数组合），之后所有的请求都携带这个token，在有效期内服务器进行验证。由于攻击者无法获取这个随机的token，可以防护csrf攻击。
  - 3.为Set-Cookie响应头新增Samesite属性
    - SameSite有3个可选值： Strict, Lax和None
    - Samesite=Strict，严格模式，浏览器完全禁止第三方cookie，只有本站点访问本站点的资源，才会携带cookie
    - Samesite=Lax，宽松模式，在跨站点的情况下，从第三方站点链接打开和从第三方站点提交 Get方式的表单这两种方式都会携带Cookie。但如果在第三方站点中使用POST方法或者通过 img、Iframe等标签加载的URL，这些场景都不会携带Cookie。
    - Samesite=none，任何情况下都可以发送cookie数据

## 参考资料
   - [XSS和CSRF两种攻击方式总结](https://blog.csdn.net/JunDao73/article/details/122897785)
   - [详解XSS和CSRF](https://www.cnblogs.com/zhouyyBlog/p/14505961.html)